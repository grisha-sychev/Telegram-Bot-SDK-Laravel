# TegBot - –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π Laravel SDK –¥–ª—è Telegram –±–æ—Ç–æ–≤

![Laravel](https://img.shields.io/badge/laravel-%23FF2D20.svg?style=for-the-badge&logo=laravel&logoColor=white)
![MySQL](https://img.shields.io/badge/mysql-4479A1.svg?style=for-the-badge&logo=mysql&logoColor=white) 
![Redis](https://img.shields.io/badge/redis-%23DD0031.svg?style=for-the-badge&logo=redis&logoColor=white)
![Telegram](https://img.shields.io/badge/Telegram-2CA5E0?style=for-the-badge&logo=telegram&logoColor=white)

![Packagist Version](https://img.shields.io/packagist/v/tegbot/tegbot)
![License](https://img.shields.io/packagist/l/tegbot/tegbot)
![Downloads](https://img.shields.io/packagist/dt/tegbot/tegbot)

**TegBot** - —ç—Ç–æ –º–æ—â–Ω—ã–π –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π Laravel –ø–∞–∫–µ—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è Telegram –±–æ—Ç–æ–≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è. –ü–∞–∫–µ—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö, –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã—Ö –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –±–æ—Ç–æ–≤.

## ‚≠ê –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üõ°Ô∏è **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –í–∞–ª–∏–¥–∞—Ü–∏—è webhook'–æ–≤, –∑–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞, –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- üì± **–û–±—Ä–∞–±–æ—Ç–∫–∞ –º–µ–¥–∏–∞**: –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ç–æ, –≤–∏–¥–µ–æ, –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, —Å—Ç–∏–∫–µ—Ä–æ–≤ –∏ –∞—É–¥–∏–æ
- üîß **Middleware —Å–∏—Å—Ç–µ–º–∞**: –ì–∏–±–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
- üéØ **–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤, —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π, –æ–ø–∏—Å–∞–Ω–∏–π
- üìä **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∑–¥–æ—Ä–æ–≤—å—è –±–æ—Ç–∞
- üöÄ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: Retry –º–µ—Ö–∞–Ω–∏–∑–º, rate limiting, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- üîÑ **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: 100% –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –±–æ—Ç–∞–º–∏

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
composer require tegbot/tegbot
```

### –ü—É–±–ª–∏–∫–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```bash
php artisan vendor:publish --provider="Teg\Providers\TegbotServiceProvider"
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–æ—Ç–∞

```bash
php artisan teg:set
```

### –°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –±–æ—Ç–∞

```php
<?php

namespace App\Bots;

use Teg\Modules\UserModule;
use Teg\Modules\StateModule;

class MyBot extends AdstractBot
{
    use StateModule, UserModule;

    public function main(): void
    {
        // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥ —Å –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π
        $this->registerCommand('start', function () {
            $this->start();
        }, [
            'description' => '–ó–∞–ø—É—Å–∫ –±–æ—Ç–∞',
            'private_only' => true,
        ]);

        $this->registerCommand('help', function () {
            $this->sendSelf($this->generateHelp());
        }, [
            'description' => '–ü–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É',
        ]);

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–µ–¥–∏–∞ —Å –ø–æ–¥–ø–∏—Å—è–º–∏
        $this->mediaWithCaption(function ($mediaInfo, $caption) {
            $this->handleMedia($mediaInfo, $caption);
        });

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥
        if ($this->hasMessageText() && $this->isMessageCommand()) {
            $this->handleCommand($this->getMessageText);
        }
    }

    private function start()
    {
        $this->sendSelf('üöÄ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! –ë–æ—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ.');
    }

    private function handleMedia($mediaInfo, $caption)
    {
        $type = $mediaInfo['type'];
        $this->sendSelf("üìé –ü–æ–ª—É—á–µ–Ω —Ñ–∞–π–ª —Ç–∏–ø–∞: {$type}");
    }
}
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã

- [üîß **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞**](docs/installation.md)
- [üõ°Ô∏è **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**](docs/security.md)
- [üì± **–û–±—Ä–∞–±–æ—Ç–∫–∞ –º–µ–¥–∏–∞**](docs/media.md)
- [üéØ **–°–∏—Å—Ç–µ–º–∞ –∫–æ–º–∞–Ω–¥**](docs/commands.md)
- [üîÑ **Middleware**](docs/middleware.md)
- [üìä **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**](docs/monitoring.md)
- [‚öôÔ∏è **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**](docs/configuration.md)
- [üöÄ **–ü—Ä–∏–º–µ—Ä—ã**](docs/examples.md)

### –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ v2.0

#### üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è

```php
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
public function main(): void
{
    // safeMain() –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
    // - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç webhook –¥–∞–Ω–Ω—ã–µ
    // - –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å–æ–æ–±—â–µ–Ω–∏–π
    // - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏
    // - –õ–æ–≥–∏—Ä—É–µ—Ç –ø—Ä–æ–±–ª–µ–º—ã
}

// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
if ($this->hasMessageText()) {
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
}

if ($this->getMessageType() === 'photo') {
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ç–æ
}
```

#### üì± –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –º–µ–¥–∏–∞

```php
// –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –º–µ–¥–∏–∞ —Ñ–∞–π–ª–∞—Ö
$photoInfo = $this->getPhotoInfo();
$videoInfo = $this->getVideoInfo();
$documentInfo = $this->getDocumentInfo();

// –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
$filePath = $this->downloadFile($fileId, '/storage/downloads/');

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–µ–¥–∏–∞ —Å –ø–æ–¥–ø–∏—Å—è–º–∏
$this->mediaWithCaption(function ($mediaInfo, $caption) {
    $type = $mediaInfo['type']; // photo, video, document, etc.
    $data = $mediaInfo['data']; // —Ä–∞–∑–º–µ—Ä—ã, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –∏–º—è —Ñ–∞–π–ª–∞
    
    // –í–∞—à–∞ –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
});
```

#### üîß Middleware —Å–∏—Å—Ç–µ–º–∞

```php
// –ì–ª–æ–±–∞–ª—å–Ω—ã–µ middleware
$this->globalMiddleware([
    'spam_protection', // –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞
    'activity_logging', // –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
]);

// Middleware –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã
$this->registerCommand('admin', $callback, [
    'middleware' => [
        function ($bot, $parsed) {
            if (!$bot->isAdmin()) {
                $bot->sendSelf('üö´ –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω');
                return false;
            }
            return true;
        }
    ],
]);
```

#### üéØ –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–æ–º–∞–Ω–¥

```php
// –ö–æ–º–∞–Ω–¥–∞ —Å –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏
$this->registerCommand('ban', function ($args) {
    $userId = $args[0] ?? null;
    $reason = $args[1] ?? '–ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª';
    // –ª–æ–≥–∏–∫–∞ –±–∞–Ω–∞
}, [
    'description' => '–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è',
    'args' => ['user_id', 'reason?'],
    'admin_only' => true,
    'private_only' => true,
]);

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ø—Ä–∞–≤–∫–∏
$helpText = $this->generateHelp();
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è –±–æ—Ç–∞

```bash
php artisan teg:health
```

–†–µ–∑—É–ª—å—Ç–∞—Ç:
```
‚úÖ Telegram API: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ
‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–æ—Ç–∞: –ù–∞—Å—Ç—Ä–æ–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ  
‚úÖ –•—Ä–∞–Ω–∏–ª–∏—â–µ —Ñ–∞–π–ª–æ–≤: –î–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è –∑–∞–ø–∏—Å–∏
‚úÖ –ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: 2 –º–∏–Ω—É—Ç—ã –Ω–∞–∑–∞–¥
‚ö†Ô∏è  –ü–æ—Å–ª–µ–¥–Ω—è—è –æ—à–∏–±–∫–∞: 1 —á–∞—Å –Ω–∞–∑–∞–¥ (–æ–±—Ä–∞–±–æ—Ç–∞–Ω–∞)
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

```php
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
$this->logActivity('command_executed', [
    'command' => '/start',
    'user_id' => $this->getUserId,
    'chat_type' => $this->getChatType(),
]);

// –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫
$this->logError('API Error', $exception, [
    'method' => 'sendMessage',
    'user_id' => $this->getUserId,
]);
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–§–∞–π–ª `config/tegbot.php` —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

```php
return [
    'api' => [
        'base_url' => 'https://api.telegram.org',
        'timeout' => 30,
        'retries' => 3,
    ],
    'security' => [
        'webhook_secret' => env('TEGBOT_WEBHOOK_SECRET'),
        'admin_ids' => explode(',', env('TEGBOT_ADMIN_IDS', '')),
        'spam_protection' => [
            'enabled' => true,
            'max_messages_per_minute' => 20,
        ],
    ],
    'files' => [
        'download_path' => storage_path('app/tegbot/downloads'),
        'max_file_size' => 20 * 1024 * 1024, // 20MB
    ],
    'logging' => [
        'enabled' => true,
        'level' => 'info',
        'max_entries' => 1000,
    ],
];
```

## üöÄ –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

1. **Webhook Secret**: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `TEGBOT_WEBHOOK_SECRET` –≤ `.env`
2. **Admin IDs**: –£–∫–∞–∂–∏—Ç–µ `TEGBOT_ADMIN_IDS` –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö –∫–æ–º–∞–Ω–¥
3. **Rate Limiting**: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
4. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –í–∫–ª—é—á–∏—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
5. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```env
TEGBOT_TOKEN=your_bot_token_here
TEGBOT_WEBHOOK_SECRET=your_secret_key
TEGBOT_ADMIN_IDS=123456789,987654321
TEGBOT_DEBUG=false
TEGBOT_RATE_LIMIT=20
```

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è —Å –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –≤–µ—Ä—Å–∏–π

–ü–∞–∫–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–±—Ä–∞—Ç–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º. –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –±–æ—Ç—ã –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π.

–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π:
1. –û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é: `php artisan vendor:publish --provider="Teg\Providers\TegbotServiceProvider" --force`
2. –ó–∞–º–µ–Ω–∏—Ç–µ `main()` –Ω–∞ `safeMain()` –≤ –º–∞—Ä—à—Ä—É—Ç–∞—Ö (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
3. –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã —á–µ—Ä–µ–∑ `registerCommand()`

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

–ü–æ–ª–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –¥–æ—Å—Ç—É–ø–Ω—ã –≤ –ø–∞–ø–∫–µ [docs/examples/](docs/examples/).

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- üìß **Email**: support@tegbot.ru
- üí¨ **Telegram**: @tegbot_support
- üêõ **Issues**: [GitHub Issues](https://github.com/tegbot/tegbot/issues)
- üìñ **Wiki**: [GitHub Wiki](https://github.com/tegbot/tegbot/wiki)

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License. –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ —Ñ–∞–π–ª–µ [LICENSE](LICENSE).

## üéâ –ê–≤—Ç–æ—Ä—ã

–°–æ–∑–¥–∞–Ω–æ –∫–æ–º–∞–Ω–¥–æ–π TegBot –¥–ª—è Laravel —Å–æ–æ–±—â–µ—Å—Ç–≤–∞.

---

**TegBot v2.0** - –û—Ç –ø—Ä–æ—Ç–æ—Ç–∏–ø–∞ –∫ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤—É üöÄ
